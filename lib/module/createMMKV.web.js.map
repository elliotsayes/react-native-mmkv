{"version":3,"sources":["createMMKV.web.ts"],"names":["createTextEncoder","canUseDOM","window","document","createElement","createMMKV","config","id","Error","encryptionKey","path","storage","domStorage","global","localStorage","textEncoder","clearAll","clear","delete","key","removeItem","set","value","setItem","toString","getString","getItem","undefined","getNumber","Number","getBoolean","getBuffer","encode","getAllKeys","Object","keys","contains","recrypt"],"mappings":";;AAAA;AAEA,SAASA,iBAAT,QAAkC,qBAAlC;AAEA,MAAMC,SAAS,GACb,OAAOC,MAAP,KAAkB,WAAlB,IAAiC,qBAAAA,MAAM,CAACC,QAAP,sEAAiBC,aAAjB,KAAkC,IADrE;AAGA,OAAO,MAAMC,UAAU,GAAIC,MAAD,IAA2C;AACnE,MAAIA,MAAM,CAACC,EAAP,KAAc,cAAlB,EAAkC;AAChC,UAAM,IAAIC,KAAJ,CAAU,qCAAV,CAAN;AACD;;AACD,MAAIF,MAAM,CAACG,aAAP,IAAwB,IAA5B,EAAkC;AAChC,UAAM,IAAID,KAAJ,CAAU,gDAAV,CAAN;AACD;;AACD,MAAIF,MAAM,CAACI,IAAP,IAAe,IAAnB,EAAyB;AACvB,UAAM,IAAIF,KAAJ,CAAU,uCAAV,CAAN;AACD;;AAED,QAAMG,OAAO,GAAG,MAAM;AAAA;;AACpB,QAAI,CAACV,SAAL,EAAgB;AACd,YAAM,IAAIO,KAAJ,CACJ,kFADI,CAAN;AAGD;;AACD,UAAMI,UAAU,8CACdC,MADc,4CACd,QAAQC,YADM,kFACUZ,MADV,4CACU,QAAQY,YADlB,uCACkCA,YADlD;;AAEA,QAAIF,UAAU,IAAI,IAAlB,EAAwB;AACtB,YAAM,IAAIJ,KAAJ,CAAW,yCAAX,CAAN;AACD;;AACD,WAAOI,UAAP;AACD,GAZD;;AAcA,QAAMG,WAAW,GAAGf,iBAAiB,EAArC;AAEA,SAAO;AACLgB,IAAAA,QAAQ,EAAE,MAAML,OAAO,GAAGM,KAAV,EADX;AAELC,IAAAA,MAAM,EAAGC,GAAD,IAASR,OAAO,GAAGS,UAAV,CAAqBD,GAArB,CAFZ;AAGLE,IAAAA,GAAG,EAAE,CAACF,GAAD,EAAMG,KAAN,KAAgBX,OAAO,GAAGY,OAAV,CAAkBJ,GAAlB,EAAuBG,KAAK,CAACE,QAAN,EAAvB,CAHhB;AAILC,IAAAA,SAAS,EAAGN,GAAD;AAAA;;AAAA,iCAASR,OAAO,GAAGe,OAAV,CAAkBP,GAAlB,CAAT,+DAAmCQ,SAAnC;AAAA,KAJN;AAKLC,IAAAA,SAAS,EAAGT,GAAD,IAAS;AAClB,YAAMG,KAAK,GAAGX,OAAO,GAAGe,OAAV,CAAkBP,GAAlB,CAAd;AACA,UAAIG,KAAK,IAAI,IAAb,EAAmB,OAAOK,SAAP;AACnB,aAAOE,MAAM,CAACP,KAAD,CAAb;AACD,KATI;AAULQ,IAAAA,UAAU,EAAGX,GAAD,IAAS;AACnB,YAAMG,KAAK,GAAGX,OAAO,GAAGe,OAAV,CAAkBP,GAAlB,CAAd;AACA,UAAIG,KAAK,IAAI,IAAb,EAAmB,OAAOK,SAAP;AACnB,aAAOL,KAAK,KAAK,MAAjB;AACD,KAdI;AAeLS,IAAAA,SAAS,EAAGZ,GAAD,IAAS;AAClB,YAAMG,KAAK,GAAGX,OAAO,GAAGe,OAAV,CAAkBP,GAAlB,CAAd;AACA,UAAIG,KAAK,IAAI,IAAb,EAAmB,OAAOK,SAAP;AACnB,aAAOZ,WAAW,CAACiB,MAAZ,CAAmBV,KAAnB,CAAP;AACD,KAnBI;AAoBLW,IAAAA,UAAU,EAAE,MAAMC,MAAM,CAACC,IAAP,CAAYxB,OAAO,EAAnB,CApBb;AAqBLyB,IAAAA,QAAQ,EAAGjB,GAAD,IAASR,OAAO,GAAGe,OAAV,CAAkBP,GAAlB,KAA0B,IArBxC;AAsBLkB,IAAAA,OAAO,EAAE,MAAM;AACb,YAAM,IAAI7B,KAAJ,CAAU,wCAAV,CAAN;AACD;AAxBI,GAAP;AA0BD,CArDM","sourcesContent":["/* global localStorage */\nimport type { MMKVConfiguration, NativeMMKV } from 'react-native-mmkv';\nimport { createTextEncoder } from './createTextEncoder';\n\nconst canUseDOM =\n  typeof window !== 'undefined' && window.document?.createElement != null;\n\nexport const createMMKV = (config: MMKVConfiguration): NativeMMKV => {\n  if (config.id !== 'mmkv.default') {\n    throw new Error(\"MMKV: 'id' is not supported on Web!\");\n  }\n  if (config.encryptionKey != null) {\n    throw new Error(\"MMKV: 'encryptionKey' is not supported on Web!\");\n  }\n  if (config.path != null) {\n    throw new Error(\"MMKV: 'path' is not supported on Web!\");\n  }\n\n  const storage = () => {\n    if (!canUseDOM) {\n      throw new Error(\n        'Tried to access storage on the server. Did you forget to call this in useEffect?'\n      );\n    }\n    const domStorage =\n      global?.localStorage ?? window?.localStorage ?? localStorage;\n    if (domStorage == null) {\n      throw new Error(`Could not find 'localStorage' instance!`);\n    }\n    return domStorage;\n  };\n\n  const textEncoder = createTextEncoder();\n\n  return {\n    clearAll: () => storage().clear(),\n    delete: (key) => storage().removeItem(key),\n    set: (key, value) => storage().setItem(key, value.toString()),\n    getString: (key) => storage().getItem(key) ?? undefined,\n    getNumber: (key) => {\n      const value = storage().getItem(key);\n      if (value == null) return undefined;\n      return Number(value);\n    },\n    getBoolean: (key) => {\n      const value = storage().getItem(key);\n      if (value == null) return undefined;\n      return value === 'true';\n    },\n    getBuffer: (key) => {\n      const value = storage().getItem(key);\n      if (value == null) return undefined;\n      return textEncoder.encode(value);\n    },\n    getAllKeys: () => Object.keys(storage()),\n    contains: (key) => storage().getItem(key) != null,\n    recrypt: () => {\n      throw new Error('`recrypt(..)` is not supported on Web!');\n    },\n  };\n};\n"]}